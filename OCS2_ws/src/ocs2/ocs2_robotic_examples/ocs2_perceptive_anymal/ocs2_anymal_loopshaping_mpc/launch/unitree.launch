<launch>
  <arg name="robot_name" default="aliengo" />
  <arg name="config_name" default="unitree" />
  <arg name="rviz" default="true" />
  <arg name="performance_indices" default="true" />
  <arg name="description_name" default="ocs2_anymal_description"/>
  <arg name="target_command" default="$(find ocs2_anymal_loopshaping_mpc)/config/$(arg config_name)/targetCommand.info"/>

  <group if="$(arg rviz)">
    <!-- Load robot description -->
    <!-- <include file="$(find ocs2_anymal_models)/launch/load_urdf.launch">
          <arg name="robot_name" value="$(arg robot_name)"/>
          <arg name="description_name" value="$(arg description_name)"/>
      </include> -->

    <arg name="robot_type" default="aliengo" doc="Robot type: [a1, aliengo, go1, laikago]"/>
    <param name="$(arg description_name)" command="$(find xacro)/xacro $(find legged_perceptive_description_custom)/urdf/robot.xacro robot_type:=$(arg robot_type) sim:=true
    "/>

    <!-- Launch visualization -->
    <node name="rviz_ocs2" pkg="rviz" type="rviz" args="-d $(find ocs2_anymal_loopshaping_mpc)/config/$(arg config_name)/demo_config.rviz">
    </node>

  </group>

  <node pkg="ocs2_anymal_loopshaping_mpc" type="ocs2_anymal_loopshaping_mpc_mpc_node" name="ocs2_anymal_loopshaping_mpc_mpc_node" 
  output="screen" args="$(arg description_name) $(arg config_name) $(arg robot_name)" launch-prefix=""/>

  <node pkg="ocs2_anymal_loopshaping_mpc" type="ocs2_anymal_loopshaping_mpc_dummy_mrt_node" name="ocs2_anymal_loopshaping_mpc_dummy_mrt_node" 
  output="screen" args="$(arg description_name) $(arg config_name) $(arg robot_name)" launch-prefix="gnome-terminal -- "/>

  <node pkg="ocs2_anymal_commands" type="gait_command_node" name="gait_command_node" 
  output="screen" args="$(arg robot_name)" launch-prefix="gnome-terminal --"/>


  <!-- Launch Performance Indices Multi-plot -->
  <include if="$(arg performance_indices)" file="$(find ocs2_ros_interfaces)/launch/performance_indices.launch">
    <arg name="mpc_policy_topic_name" value="$(arg robot_name)_mpc_policy"/>
  </include>

  <node pkg="perceptive_trajectories" type="perceptive_trajectories_publisher" name="perceptive_trajectories_publisher" 
  output="screen" args="$(arg target_command) $(arg robot_name)" />

  <node pkg="tf2_ros" type="static_transform_publisher" name="odom_to_world_broadcaster" args="0 0 0 0 0 0 odom world" />

</launch>
